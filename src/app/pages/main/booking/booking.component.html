<nb-card>
  <nb-card-header>
    <div class="row">
      <div class="col-auto mr-auto">Booking Management</div>
      <div class="col-auto">
        <button type="button" class="btn btn-primary" (click)="toListBooking()">
          <i class="fa fa-th-list" aria-hidden="true"></i>
        </button>
      </div>
    </div>
  </nb-card-header>
  <nb-card-body>
    <nb-stepper #stepper >
      <nb-step [stepControl]="firstForm" label="First step">
        <div class="input-group mb-3">
          <div class="input-group-prepend">
            <span class="input-group-text" id="basic-addon1">
              <i class="fa" [ngClass]="{ 'fa-cog fa-spin': loadingClients, 'fa-search': !loadingClients }" aria-hidden="true"></i>
            </span>
          </div>
          <input
            type="text"
            fullWidth
            [disabled]="show === false"
            class="form-control"
            [(ngModel)]="modelGuest"
            [ngbTypeahead]="searchGuest" 
            (ngModelChange)="onChangeGuest($event)"
            [resultTemplate]="guest"
            [inputFormatter]="formatterGuest"
            placeholder="Guest">
        </div>

        <ng-template #guest let-r="result" let-t="term">
          <div class="media p-1">
            <div class="d-flex justify-content-center align-content-center align-items-center">
              <i class="fa fa-user-circle fa-2x mr-3" aria-hidden="true"></i>
            </div>
            <div class="media-body">
              <h5 class="mt-1">{{r.guestName}}</h5>
            </div>
          </div>
        </ng-template>


        <div class="input-group mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">
                <i class="fa" [ngClass]="{ 'fa-cog fa-spin': loadingClients, 'fa-search': !loadingClients }" aria-hidden="true"></i>
              </span>
            </div>
            <input
              type="text"
              fullWidth
              [disabled]="show === false"
              class="form-control"
              [(ngModel)]="modelBusinessSource"
              [ngbTypeahead]="searchBusinessSource" 
              (ngModelChange)="onChangeBusinessSource($event)"
              [resultTemplate]="businessSource"
              [inputFormatter]="formatterBusinessSource"
              placeholder="Business Source">
          </div>

          <ng-template #businessSource let-r="result" let-t="term">
            <div class="media p-1">
              <div class="d-flex justify-content-center align-content-center align-items-center">
                <i class="fa fa-user-circle fa-2x mr-3" aria-hidden="true"></i>
              </div>
              <div class="media-body">
                <h5 class="mt-1">{{r.businnessSourceName}}</h5>
              </div>
            </div>
          </ng-template>

        <form class="step-container">
          <div class="form-group">
            <label for="exampleFormControlInput1">Name</label>
            <input
            type="text"
            nbInput
            fullWidth
            [disabled]="show === false"
            class="form-control"
            [(ngModel)]="bookingStepOne.guestName"
            id="guestName"
            name="guestName"
            required
            #guestName="ngModel"
            placeholder="Guest name">
          </div>
  
          <div class="form-group">
            <label for="exampleFormControlSelect1">Country</label>
            <select
            nbInput
            fullWidth
            [disabled]="show === false"
            class="form-control"
            [(ngModel)]="bookingStepOne.countryId"
            id="typeId"
            name="typeId"
            required
            #typeId="ngModel">
              <option
              *ngFor="let country of country"
              value="{{country.countryId}}">{{country.countryName}}</option>
            </select>
          </div>
  
          <div class="form-group">
            <label for="exampleFormControlInput1">Address</label>
            <textarea
            nbInput
            fullWidth
            [disabled]="show === false"
            class="form-control"
            [(ngModel)]="bookingStepOne.address"
            id="address"
            name="address"
            required
            #address="ngModel"
            placeholder="Description">
            </textarea>
          </div>

          <div class="form-group">
            <label for="exampleFormControlInput1">Source</label>
            <input
            type="text"
            nbInput
            fullWidth
            [disabled]="show === false"
            class="form-control"
            [(ngModel)]="bookingStepOne.sourceName"
            id="sourceName"
            name="sourceName"
            required
            #sourceName="ngModel"
            placeholder="Busineess source">
          </div>
  
          <div class="form-row">
            <div class="form-group col-md-6">
              <label for="inputEmail4">Arrival Date</label>
              <input
              [nbDatepicker]="fromDate"
              [(ngModel)]="bookingStepOne.arrivalDate"
              class="form-control"
              id="arrivalDate"
              name="arrivalDate"
              required
              [disabled]="show === false"
              #arrivalDate="ngModel"
              placeholder="From Date">
              <nb-datepicker
                #fromDate
                format="MMM d, y">
              </nb-datepicker>
            </div>

            <div class="form-group col-md-6">
              <label for="exampleFormControlInput1">Duration</label>
              <input
              type="number"
              min = 1
              nbInput
              fullWidth
              [disabled]="show === false"
              class="form-control"
              [(ngModel)]="bookingStepOne.duration"
              id="duration"
              name="duration"
              required
              #duration="ngModel"
              placeholder="Duration">
            </div>
          </div>

          <div class="buttons">
            <button nbButton nbStepperNext (click)="saveStepOne()">next</button>
          </div>
        </form>
      </nb-step>


      <nb-step [stepControl]="secondForm" label="Second step">
        <form (ngSubmit)="onSecondSubmit()" class="step-container">
          <div class="input-group mb-3" *ngFor="let roomListBooking of roomListBooking; let i=index">
            <div class="input-group-prepend">
              <div class="input-group-text">
                <input 
                type="checkbox"
                [(ngModel)]="roomListBooking.check"
                id="check{{i}}"
                name="check{{i}}"
                (ngModelChange)="checkRoomListBooking($event)">
              </div>
            </div>
            <input
              type="text"
              fullWidth
              disabled
              [(ngModel)]="roomListBooking.roomTypeName"
              class="form-control"
              id="roomTypeName{{i}}"
              name="roomTypeName{{i}}"
              placeholder="Guest">
            <input
            type="number"
            fullWidth
            [max]="roomListBooking.available"
            [disabled]="show === false"
            [(ngModel)]="roomListBooking.available"
            id="available{{i}}"
            name="available{{i}}"
            class="form-control"
            placeholder="Guest">
          </div>

          <button nbButton nbStepperPrevious (click)="resetStepOne()">prev</button>
          <button nbButton nbStepperNext (click)="saveStepTwo()">next</button>
        </form>
      </nb-step>
      <nb-step [stepControl]="thirdForm" [hidden]="true" label="Third step">
        <div class="step-container">
          <h3>completed!</h3>
          <!-- <button nbButton (click)="stepper.reset()">Try again</button> -->
        </div>
      </nb-step>
    </nb-stepper>
  </nb-card-body>
</nb-card>

