<!-- TODO: Start Action Group Booking Room -->
<nb-card>
  <nb-card-body class="nb-card-body">
    <div class="action-groups-header">
      Action Detail Room
    </div>
    <nb-actions size="medium">
      <!-- ! Nota -->
      <nb-action
        icon="fa fa-print"
        style="-webkit-text-fill-color: black"
        nbTooltip="Print Nota"
        nbTooltipPlacement="bottom"
        (click)="goToNota()">
      </nb-action>

      <!-- ! add payment - Done -->
      <nb-action
        *ngIf="charge.total !== 0 && detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId !== 5"
        icon="fab fa-paypal"
        style="-webkit-text-fill-color: blue"
        nbTooltip="Add Payment"
        nbTooltipPlacement="bottom"
        (click)="openAddPayment(dialogPayment)">
      </nb-action>

      <!-- ! add deposit - Done -->
      <nb-action
      *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId !== 5"
        icon="fa fa-wallet"
        style="-webkit-text-fill-color: royalblue"
        nbTooltip="Add Deposit"
        nbTooltipPlacement="bottom"
        (click)="openAddDeposit(dialogDeposit)">
      </nb-action>

      <!-- ! add Discount - Done -->
      <nb-action
      *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId !== 5"
        icon="fa fa-percent"
        nbTooltip="Add Discount"
        style="-webkit-text-fill-color: aqua"
        nbTooltipPlacement="bottom"
        (click)="openAddDiscount(dialogDiscount)">
      </nb-action>

      <!-- ! add extra charge - Done -->
      <nb-action
      *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId !== 5"
        icon="fa fa-gift"
        style="-webkit-text-fill-color: lightseagreen"
        nbTooltip="Add Extra Charge"
        nbTooltipPlacement="bottom"
        (click)="openDialogExtraCHarge(dialogExtraCharge)">
      </nb-action>

      <!-- ! add room - Done -->
      <nb-action
      *ngIf="detailBookingByBookingRoomId.roomInformation.roomId === null && detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId !== 5"
      icon="fa fa-bed"
      style="-webkit-text-fill-color: orange"
      nbTooltip="Add Room"
      nbTooltipPlacement="bottom"
      (click)="openAddRoom(dialogAddRoom)">
      </nb-action>

      <!-- !move room - Done -->
      <nb-action
        *ngIf="detailBookingByBookingRoomId.roomInformation.roomId !== null && detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId !== 5"
        icon="fas fa-dolly-flatbed"
        style="-webkit-text-fill-color: lightsalmon"
        nbTooltip="Move Room"
        nbTooltipPlacement="bottom"
        (click)="goToMoveRoom()">
      </nb-action>
      
      <!-- !add stay - Done -->
      <nb-action
        *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId === 3"
        icon="fa fa-plus-circle"
      style="-webkit-text-fill-color: violet"
        nbTooltip="Add Stay"
        nbTooltipPlacement="bottom"
        (click)="goToAddStay()">  
      </nb-action>


      <!-- !less stay - Done -->
      <nb-action
        *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId === 3"
        icon="fa fa-minus-circle"
      style="-webkit-text-fill-color: lightpink"        
        nbTooltip="Less Stay"
        nbTooltipPlacement="bottom"
        (click)="goToLessStay()">
      </nb-action>

      <!-- ! check in - Done -->
      <nb-action
      *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId === 2"
        icon="fas fa-user-check"
      style="-webkit-text-fill-color: darkgreen"
        nbTooltip="Check In"
        nbTooltipPlacement="bottom"
        (click)="openActionCheckIn(dialogCheckIn)">
      </nb-action>

      <!-- ! check out - Done -->
      <nb-action
      *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId === 3"
        icon="fas fa-sign-out-alt"
      style="-webkit-text-fill-color: lightgreen"        
        nbTooltip="Check out"
        nbTooltipPlacement="bottom"
        (click)="openActionCheckOut(dialogCheckOut)">
      </nb-action>

      <!-- ! no show - Done -->
      <nb-action
      *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId === 2"
        icon="fas fa-eye-slash"
        style="-webkit-text-fill-color: gray"
        nbTooltip="No Show"
        nbTooltipPlacement="bottom"
        (click)="noShow()">
      </nb-action>

      <!-- ! cancel booking - Done -->
      <nb-action
      *ngIf="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId !== 3 && detailBookingByBookingRoomId.roomInformation.bookingRoomStatusId !== 5"
        icon="fas fa-eject"
        style="-webkit-text-fill-color: red"
        nbTooltip="Cancel"
        nbTooltipPlacement="bottom"
        (click)="cancelBookingRoom()">
      </nb-action>

      <!-- ! back to booking detail based on booking id - Done  -->
      <nb-action
      icon="fa fa-undo"
      style="-webkit-text-fill-color: yellow"
      nbTooltip="Undo"
      nbTooltipPlacement="bottom"
      [routerLink]="['/pages/booking-detail/' + this.detailBookingByBookingRoomId.roomInformation.bookingId]"
      routerLinkActive="router-link-active">
      </nb-action>

    </nb-actions>
</nb-card-body>
</nb-card>
<!-- TODO: End Action Group Booking Room -->

<!-- TODO: Start Tabs -->
<nb-card> 
  <nb-card-header>
    <div class="row">
      <div class="col-auto mr-auto">
        Booking Room : {{detailBookingByBookingRoomId.roomInformation.bookingRoomId}} - {{detailBookingByBookingRoomId.roomInformation.roomTypeName}} 
      </div>
    </div>
  </nb-card-header>

  <nb-card-body>
    <nb-tabset>

      <!-- ! Booking information -->
      <nb-tab tabTitle="Booking Room Infomation">
        <nb-card>
          <nb-card-body>

            <!-- TODO: START Data of Booking information -->
            <nb-card>
              <nb-card-header>
                <div class="row">
                  <div class="col-auto mr-auto">Information</div>
                </div>
              </nb-card-header>
              <nb-card-body>
                <div class="row">
                  <div class="col-12">
                    <div class="form-group">
                      <label for="inputEmail4">Arrival Date</label>
                      <input
                      [nbDatepicker]="arrivalDate"
                      [(ngModel)]="detailBookingByBookingRoomId.roomInformation.arrivalDate"
                      class="form-control"
                      id="arrivalDate"
                      name="arrivalDate"
                      required
                      disabled
                      #arrivalDate="ngModel"
                      placeholder="Arrival Date">
                      <nb-datepicker
                        #arrivalDate
                        format="MMM d, y">
                      </nb-datepicker>
                    </div>
                
                    <div class="form-group">
                      <label for="inputEmail4">Departure Date</label>
                      <input
                      [nbDatepicker]="departureDate"
                      [(ngModel)]="detailBookingByBookingRoomId.roomInformation.departureDate"
                      class="form-control"
                      id="departureDate"
                      name="departureDate"
                      required
                      disabled
                      #departureDate="ngModel"
                      placeholder="Departure Date">
                      <nb-datepicker
                        #departureDate
                        format="MMM d, y">
                      </nb-datepicker>
                    </div>
                
                    <div class="form-group">
                      <label for="exampleFormControlInput1">Room type name</label>
                      <input
                      type="text"
                      nbInput
                      fullWidth
                      disabled
                      class="form-control"
                      [(ngModel)]="detailBookingByBookingRoomId.roomInformation.roomTypeName"
                      id="roomTypeName"
                      name="roomTypeName"
                      required
                      #roomTypeName="ngModel"
                      placeholder="Room type name">
                    </div>
                
                    <div class="form-group" *ngIf="detailBookingByBookingRoomId.roomInformation.roomId !== null">
                      <label for="exampleFormControlInput1">Room name</label>
                      <input
                      type="text"
                      nbInput
                      fullWidth
                      disabled
                      class="form-control"
                      [(ngModel)]="detailBookingByBookingRoomId.room.roomName"
                      id="roomName"
                      name="roomName"
                      required
                      #roomName="ngModel"
                      placeholder="Room name">
                    </div>
                
                    <div class="form-group">
                      <label for="exampleFormControlInput1">Booking room status name</label>
                      <input
                      type="text"
                      nbInput
                      fullWidth
                      disabled
                      class="form-control"
                      [(ngModel)]="detailBookingByBookingRoomId.roomInformation.bookingRoomStatusName"
                      id="bookingRoomStatusName"
                      name="bookingRoomStatusName"
                      required
                      #bookingRoomStatusName="ngModel"
                      placeholder="Booking room status name">
                    </div>
                  </div>
                </div>
              </nb-card-body>
            </nb-card>
            <!-- TODO: END Data of Booking information -->
          </nb-card-body>
        </nb-card>
      </nb-tab>

      <!-- ! Charge information -->
      <nb-tab tabTitle="Charge Information">
        <nb-card>
          <nb-card-body>
              <ng2-smart-table [settings]="settingCharge"  [source]="chargeInformation"></ng2-smart-table>
          </nb-card-body>
        </nb-card>
      </nb-tab>

      <!-- ! Extra Charge information -->
      <nb-tab tabTitle="Extra Charge Information">
        <nb-card>
          <nb-card-body>
              <ng2-smart-table [settings]="settingExtraCharge"  [source]="extraChargeInformation"></ng2-smart-table>
          </nb-card-body>
        </nb-card> 
      </nb-tab>

      <!-- ! Charge Total -->
      <nb-tab tabTitle="Charge Total">
        <nb-card>
          <nb-card-body>
            <div class="row">
              <div class="col-12">
                <div class="form-group">
                  <label for="exampleFormControlInput1">Discount total</label>
                  <input
                  type="text"
                  nbInput
                  fullWidth
                  disabled
                  currencyMask
                  class="form-control"
                  [(ngModel)]="detailBookingByBookingRoomId.chargeTotal.discountTotal"
                  id="discountTotal"
                  name="discountTotal"
                  required
                  #discountTotal="ngModel"
                  placeholder="Discount total">
                </div>
            
                <div class="form-group">
                  <label for="exampleFormControlInput1">Rate total</label>
                  <input
                  type="text"
                  nbInput
                  fullWidth
                  disabled
                  currencyMask
                  class="form-control"
                  [(ngModel)]="detailBookingByBookingRoomId.chargeTotal.rateTotal"
                  id="rateTotal"
                  name="rateTotal"
                  required
                  #rateTotal="ngModel"
                  placeholder="Rate total">
                </div>
            
                <div class="form-group">
                  <label for="exampleFormControlInput1">Tax total</label>
                  <input
                  type="text"
                  nbInput
                  fullWidth
                  disabled
                  currencyMask
                  class="form-control"
                  [(ngModel)]="detailBookingByBookingRoomId.chargeTotal.taxTotal"
                  id="taxtTotal"
                  name="taxtTotal"
                  required
                  #taxtTotal="ngModel"
                  placeholder="Tax total">
                </div>
            
                <div class="form-group">
                  <label for="exampleFormControlInput1">Total</label>
                  <input
                  type="text"
                  nbInput
                  fullWidth
                  disabled
                  currencyMask
                  class="form-control"
                  [(ngModel)]="detailBookingByBookingRoomId.chargeTotal.total"
                  id="total"
                  name="total"
                  required
                  #total="ngModel"
                  placeholder="Total">
                </div>
              </div>
            </div>
          </nb-card-body>
        </nb-card> 
      </nb-tab>

      <!-- ! Payment Information -->
      <nb-tab tabTitle="Payment Information">
        <nb-card>
          <nb-card-body>
            <ng2-smart-table [settings]="settingPayment"  [source]="paymentInformation"></ng2-smart-table>
          </nb-card-body>
        </nb-card> 
      </nb-tab>
      
      <!-- ! History -->
      <nb-tab tabTitle="History">
        <nb-card>
          <nb-card-body>
            <ng2-smart-table [settings]="settingHistory"  [source]="history"></ng2-smart-table>
          </nb-card-body>
        </nb-card>
      </nb-tab>
    </nb-tabset>
  </nb-card-body>
</nb-card>
<!-- TODO: End Tabs -->

<!-- TODO: Start Templating -->

<!-- ! payment -->
<ng-template #dialogPayment let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      Add Payment
    </nb-card-header>
    <nb-card-body>
      <div class="form-group">
        <label for="exampleFormControlInput1">Total paid</label>
        <input
        type="text"
        nbInput
        fullWidth
        disabled
        currencyMask
        class="form-control"
        [(ngModel)]="dataAddPaymentCharge.totalPaid"
        id="totalPaid"
        name="totalPaid"
        required
        #totalPaid="ngModel"
        placeholder="Total paid">
      </div>

      <div class="form-group">
          <label for="exampleFormControlSelect1">Payment Type</label>
          <select
            nbInput
            fullWidth
            [disabled]="show === false"
            class="form-control"
            [(ngModel)]="dataAddPaymentCharge.paymentTypeId"
            id="paymentTypeId"
            name="paymentTypeId"
            required
            #paymentTypeId="ngModel">
            <option value="0" disabled selected>Choose your payment option</option>
            <option
            *ngFor="let paymentType of paymentType"
            value="{{paymentType.paymentTypeId}}">{{paymentType.paymentTypeName}}</option>
          </select>
        </div>

      <div class="form-group">
          <label for="exampleFormControlInput1">Payment Note</label>
          <textarea
          nbInput
          fullWidth
          class="form-control"
          [(ngModel)]="dataAddPaymentCharge.paymentNote"
          id="paymentNote"
          name="paymentNote"
          required
          #paymentNote="ngModel"
          placeholder="Payment Note"></textarea>
        </div>
    </nb-card-body>
    <nb-card-footer>
      <button type="button" class="btn btn-primary btnn" (click)="addPaymentCharge()" (click)="ref.close()">Save</button>
      <button type="button" class="btn btn-warning btnn" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- ! deposit -->
<ng-template #dialogDeposit let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      Add Deposit
    </nb-card-header>
    <nb-card-body>
      <div class="form-group">
        <label for="exampleFormControlInput1">Total paid</label>
        <input
        type="text"
        nbInput
        fullWidth
        disabled
        currencyMask
        class="form-control"
        [(ngModel)]="dataAddPaymentDeposit.totalPaid"
        id="totalPaid"
        name="totalPaid"
        required
        #totalPaid="ngModel"
        placeholder="Total paid">
      </div>

      <div class="form-group">
        <label for="exampleFormControlSelect1">Payment Type</label>
        <select
          nbInput
          fullWidth
          [disabled]="show === false"
          class="form-control"
          [(ngModel)]="dataAddPaymentDeposit.paymentTypeId"
          id="paymentTypeId"
          name="paymentTypeId"
          required
          #paymentTypeId="ngModel">
          <option value="0" disabled selected>Choose your payment option</option>
          <option
          *ngFor="let paymentType of paymentType"
          value="{{paymentType.paymentTypeId}}">{{paymentType.paymentTypeName}}</option>
        </select>
      </div>

      <div class="form-group">
          <label for="exampleFormControlInput1">Payment Note</label>
          <textarea
          nbInput
          fullWidth
          class="form-control"
          [(ngModel)]="dataAddPaymentDeposit.paymentNote"
          id="paymentNote"
          name="paymentNote"
          required
          #paymentNote="ngModel"
          placeholder="Payment Note"></textarea>
        </div>
    </nb-card-body>
    <nb-card-footer>
      <button type="button" class="btn btn-primary btnn" (click)="addPaymentDeposit()" (click)="ref.close()">Save</button>
      <button type="button" class="btn btn-warning btnn" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- ! discount -->
<ng-template #dialogDiscount let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      Add Discount
    </nb-card-header>
    <nb-card-body>
      <div class="form-group">
        <label for="exampleFormControlSelect1">Charge for date</label>
        <select
          nbInput
          fullWidth
          [disabled]="show === false"
          class="form-control"
          [(ngModel)]="editCharge.chargeId"
          id="chargeId"
          name="chargeId"
          required
          (change)="getChargeDiscount($event)"
          #chargeId="ngModel">
          <option value="0" disabled selected>Choose your Charge option</option>
          <option
          *ngFor="let chargeDisc of chargeDisc"
          value="{{chargeDisc.chargeId}}">{{chargeDisc.paymentForDate}}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="exampleFormControlSelect1">Discount</label>
        <select
          nbInput
          fullWidth
          [disabled]="show === false"
          class="form-control"
          [(ngModel)]="editCharge.discountId"
          id="discountId"
          name="discountId"
          required
          (change)="getChargeDiscountTwo($event)"
          #discountId="ngModel">
          <option value="0" disabled selected>Choose your discount option</option>
          <option
          *ngFor="let discount of discount"
          value="{{discount.discountId}}">{{discount.discountName}}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="exampleFormControlInput1">Discount total</label>
        <input
        type="text"
        nbInput
        fullWidth
        disabled
        currencyMask
        class="form-control"
        [(ngModel)]="editCharge.discountTotal"
        id="discountTotal"
        name="discountTotal"
        required
        #discountTotal="ngModel"
        placeholder="Total paid">
      </div>

      <div class="form-group">
        <label for="exampleFormControlInput1">Charge Note</label>
        <textarea
        nbInput
        fullWidth
        class="form-control"
        [(ngModel)]="editCharge.chargeNote"
        id="chargeNote"
        name="chargeNote"
        required
        #chargeNote="ngModel"
        placeholder="Charge Note"></textarea>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <button type="button" class="btn btn-primary btnn" (click)="addDiscount()" (click)="ref.close()">Save</button>
      <button type="button" class="btn btn-warning btnn" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- ! check in -->
<ng-template #dialogCheckIn let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      Check In
    </nb-card-header>
    <nb-card-body>
      <nb-checkbox (change)="toggleCheckin($event)">Early Check In</nb-checkbox>
    </nb-card-body>
    <nb-card-footer>
      <button type="button" class="btn btn-primary btnn" (click)="checkIn()" (click)="ref.close()">Save</button>
      <button type="button" class="btn btn-warning btnn" (click)="cancelCheckIn()" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- ! check out -->
<ng-template #dialogCheckOut let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      Check Out
    </nb-card-header>
    <nb-card-body>
        <nb-checkbox (change)="toogleCheckOut($event)">Late Check Out</nb-checkbox>
        <div class="form-group" *ngIf="checkedCheckOut === true">
          <label for="exampleFormControlSelect1">Payment Type</label>
          <select
            nbInput
            fullWidth
            [disabled]="show === false"
            class="form-control"
            [(ngModel)]="actionCheckOut.lateCheckOutRate"
            id="lateCheckOutRate"
            name="lateCheckOutRate"
            required
            #lateCheckOutRate="ngModel">
            <option value="0" disabled>Choose your option</option>
            <option value="25">13:01 AM - 14.00 AM</option>
            <option value="50">14:01 AM - 15.00 AM</option>
          </select>
        </div>
    </nb-card-body>
    <nb-card-footer>
      <button type="button" class="btn btn-primary btnn" (click)="checkOut()" (click)="ref.close()">Save</button>
      <button type="button" class="btn btn-warning btnn" (click)="cancelCheckOut()"  (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- ! add extra charge -->
<ng-template #dialogExtraCharge let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      Add Extra Charge 
    </nb-card-header>
    <nb-card-body>
      <div class="form-group">
        <label for="exampleFormControlSelect1">Extra Charge</label>
        <select
          nbInput
          fullWidth
          [disabled]="show === false"
          class="form-control"
          [(ngModel)]="dataAddExtraPaymentDeposit.extraChargeId"
          id="extraChargeId"
          name="extraChargeId"
          required
          #extraChargeId="ngModel">
          <option value="0" disabled selected>Choose your option</option>
          <option
          *ngFor="let extraCharge of extraCharge"
          value="{{extraCharge.extraChargeId}}">{{extraCharge.extraChargeName}}</option>
        </select>
      </div>

      <div class="form-group">
          <label for="exampleFormControlSelect1">Payment Type</label>
          <select
            nbInput
            fullWidth
            [disabled]="show === false"
            class="form-control"
            [(ngModel)]="dataAddExtraPaymentDeposit.paymentTypeId"
            id="paymentTypeId"
            name="paymentTypeId"
            required
            #paymentTypeId="ngModel">
            <option value="0" disabled selected>Choose your option</option>
            <option
            *ngFor="let paymentType of paymentType"
            value="{{paymentType.paymentTypeId}}">{{paymentType.paymentTypeName}}</option>
          </select>
        </div>

      <div class="form-group">
          <label for="exampleFormControlInput1">Extra Payment Note</label>
          <textarea
          nbInput
          fullWidth
          class="form-control"
          [(ngModel)]="dataAddExtraPaymentDeposit.extraPaymentNote"
          id="extraPaymentNote"
          name="extraPaymentNote"
          required
          #extraPaymentNote="ngModel"
          placeholder="Extra Payment Note"></textarea>
        </div>
    </nb-card-body>
    <nb-card-footer>
      <button type="button" class="btn btn-primary btnn" (click)="addPaymentExtraCharge()" (click)="ref.close()">Save</button>
      <button type="button" class="btn btn-warning btnn" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- ! Add room -->
<ng-template #dialogAddRoom let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      <div class="row">
        <div class="col-auto mr-auto">Assign Room</div>
      </div>
    </nb-card-header>
    <nb-card-body>
      <div class="row">
        <div class="col-12">
          <div class="form-group">
            <label for="exampleFormControlSelect1">Room</label>
            <select
            nbInput
            fullWidth
            [disabled]="role === false"
            class="form-control"
            [(ngModel)]="assignRoom.roomId"
            id="roomId"
            name="roomId"
            required
            #roomId="ngModel">
            <option value="0" disabled selected>Choose your room option</option>
            <option
            *ngFor="let room of room"
            value="{{room.roomId}}">{{room.roomName}}</option>
            </select>
          </div>
        </div>
      </div>
    </nb-card-body>
    <nb-card-footer>
        <button type="button" class="btn btn-primary btnn" (click)="addAssignRoom()" (click)="ref.close()">Save</button>
        <button type="button" class="btn btn-warning btnn" (click)="ref.close()">Cancel</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- ! extend room -->


<!-- TODO: End Templating -->